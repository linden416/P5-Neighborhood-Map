function getGoogleMap_n_Markers(){function e(e,a){if(a==google.maps.places.PlacesServiceStatus.OK){var o=new google.maps.Marker({map:map,position:e.geometry.location}),t=e.name;e.name.indexOf("CNN")>-1?t="CNN Center":e.name.indexOf("Fox")>-1?t="Fox Theatre":e.name.indexOf("Georgia Institute of Technology")>-1&&(t="Georgia Tech"),markersHash[t]=o,google.maps.event.addListener(o,"click",function(){infowindow.setContent(buildInfoWindowContent(t)),infowindow.open(map,o)}),google.maps.event.addListener(o,"mouseover",function(){infowindow.setContent(t),infowindow.open(map,o)})}}console.log("getGoogleMap_n_Markers"),map=new google.maps.Map(document.getElementById("map-canvas"),{center:new google.maps.LatLng(Atlanta.latitude,Atlanta.longitude),zoom:Atlanta.zoom});var a=$(window).height(),o=10;$("#map-canvas").css("height",a-o),infowindow=new google.maps.InfoWindow,google.maps.event.addListener(infowindow,"closeclick",function(){map.setCenter(new google.maps.LatLng(Atlanta.latitude,Atlanta.longitude)),map.setZoom(Atlanta.zoom)});for(var t=new google.maps.places.PlacesService(map),n=0;n<predefinedlocations.length;n++){var i="<h3>"+predefinedlocations[n].place+"</h3>";i+="<p id='address'>"+predefinedlocations[n].address+"</p>",locationHash[predefinedlocations[n].place]=i;var s={placeId:predefinedlocations[n].PlaceId};t.getDetails(s,e)}}function getFlickrPhotos(){console.log("getFlickrPhotos");{var e="https://api.flickr.com/services/rest/?method=flickr.galleries.getPhotos",a={api_key:"77b04d2ba00b81ecf907fb0c3c7498b0",gallery_id:"131654409-72157649533974933",format:"json",nojsoncallback:"1"};$.getJSON(e,a).done(function(e){if("ok"===e.stat)for(var a=0;a<e.photos.total;a++){var o=e.photos.photo[a].farm,t=e.photos.photo[a].server,n=e.photos.photo[a].id,i=e.photos.photo[a].secret,s=e.photos.photo[a].title,r="https://farm"+o+".staticflickr.com/"+t+"/"+n+"_"+i+".jpg";s=s.toLowerCase();for(var l=0;l<predefinedlocations.length;l++){var c=predefinedlocations[l].place;if(c=c.toLowerCase(),s.indexOf(c)>-1){var d="<div id='flickrDiv'><hr><p id='flickrTagname'>Flickr</p>";d+="<img id='flickrImg' src='"+r+"' alt='Flickr Image'></img>",d+="</div>",flickrHash[predefinedlocations[l].place]=d,l=predefinedlocations.length}}}}).fail(function(){console.log("Failed to access flickr.galleries.getPhotos!")})}}function getWikiInformation(){console.log("getWikiInformation");for(var e=setTimeout(function(){console.log("Failed to access Wikipedia")},8e3),a=0;a<predefinedlocations.length;a++){var o=predefinedlocations[a].place;"Fox Theatre"===o&&(o=predefinedlocations[a].place+" (Atlanta)"),$.ajax({url:"http://en.wikipedia.org/w/api.php",data:{action:"opensearch",format:"json",redirects:"resolve",search:o},dataType:"jsonp",jsoncallback:""}).done(function(a){var o=a[0],t=a[1][0],n=a[3][0],i=a[2][0],s="<div id='wikiLink'><hr><p id='wikiTagname'>Wikipedia</p>";s+="<a id='wikiLink' href='"+n+"'>"+t+"</a><p id='wikiSummary'>"+i+"</p></div>",o.indexOf("(Atlanta)")>1&&(o=o.substring(0,o.indexOf(" (Atlanta)"))),wikiHash[o]=s,clearTimeout(e)}).fail(function(){console.log("An exception occurred accessing Wikipedia")}).always(function(){})}}function buildInfoWindowContent(e){console.log("buildInfoWindowContent");var a="<div id='contentInfo'>";return a+=locationHash[e],a+=flickrHash[e],a+=wikiHash[e],a+="</div>"}var predefinedlocations=[{place:"Piedmont Park",PlaceId:"ChIJlxti7TgE9YgRSjhV1kb_mbY",address:"1342 Worchester Drive Northeast, Atlanta, GA 30306, United States"},{place:"Georgia Tech",PlaceId:"ChIJ40_D64oE9YgRD8XYOj7QKrU",address:"North Ave NW, Atlanta, GA 30332, United States"},{place:"High Museum of Art",PlaceId:"ChIJf8bUMEUE9YgR8nttKmmxaPc",address:"1280 Peachtree Street Northeast, Atlanta, GA 30309, United States"},{place:"Georgia Aquarium",PlaceId:"ChIJGQT0RX4E9YgR3EqvqXZw1_4",address:"225 Baker Street Northwest, Atlanta, GA 30313, United States"},{place:"Woodruff Arts Center",PlaceId:"ChIJf8bUMEUE9YgRI5s3hH594AY",address:"1280 Peachtree Street Northeast, Atlanta, GA 30309, United States"},{place:"Atlantic Station",PlaceId:"ChIJVbS_XvcE9YgRBnYS_RrLgHg",address:"Atlantic Station, Atlanta, GA, USA"},{place:"CNN Center",PlaceId:"ChIJd_c_Y4AD9YgRHw-SJKG4z4k",address:"190 Marietta Street Northwest, Atlanta, GA 30303, United States"},{place:"Georgia World Congress Center",PlaceId:"ChIJiadaA4AD9YgRd4ebM1r2cgA",address:"285 Andrew Young International Blvd NW, Atlanta, GA 30303"},{place:"World of Coca-Cola",PlaceId:"ChIJ8yjI7H4E9YgRyacfAZqyAUQ",address:"121 Baker St NW, Atlanta, GA 30313"},{place:"Fox Theatre",PlaceId:"ChIJ28DQdm8E9YgRnsZ4YZ94nRo",address:"660 Peachtree Street Northeast, Atlanta, GA 30308, United States"}],Atlanta={latitude:33.780423,longitude:-84.3908896,zoom:14},markersHash={},wikiHash={},flickrHash={},locationHash={},map={},infowindow={},ViewModel=function(){var e=this;e.searchPattern=ko.observable(),e.filteredLocationsList=ko.observableArray([]),predefinedlocations.forEach(function(a){e.filteredLocationsList.push(new Location(a))}),e.displayLocationInfoWindow=function(e){console.log(e.place()),infowindow.setContent(buildInfoWindowContent(e.place())),infowindow.open(map,markersHash[e.place()])},e.displayLocationTitle=function(e){console.log(e.place()),infowindow.setContent(e.place()),infowindow.open(map,markersHash[e.place()])},e.searchLocations=function(){void 0!==e.searchPattern()&&(e.filteredLocationsList.removeAll(),predefinedlocations.forEach(function(a){if(0===e.searchPattern().length)e.filteredLocationsList.push(new Location(a)),markersHash[a.place].setVisible(!0);else{var o=e.searchPattern().toLowerCase(),t=a.place.toLowerCase();0===t.indexOf(o)?(e.filteredLocationsList.push(new Location(a)),markersHash[a.place].setVisible(!0)):markersHash[a.place].setVisible(!1)}}))},getGoogleMap_n_Markers(),getFlickrPhotos(),getWikiInformation(),$("#searchId").focus()},Location=function(e){this.place=ko.observable(e.place),this.PlaceId=ko.observable(e.PlaceId),this.address=ko.observable(e.address)};ko.applyBindings(new ViewModel),$(window).resize(function(){var e=$(window).height(),a=10;$("#map-canvas").css("height",e-a)}).resize();